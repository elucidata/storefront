!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Storefront=t()}}(function(){return function t(e,n,i){function r(o,a){if(!n[o]){if(!e[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(s)return s(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[o]={exports:{}};e[o][0].call(u.exports,function(t){var n=e[o][1][t];return r(n?n:t)},u,u.exports,t,e,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e){var n=t("./lib/runtime");e.exports=n.newInstance()},{"./lib/runtime":10}],2:[function(t,e){e.exports=function(){var t=Array.prototype.slice.call(arguments),e=t.shift(),n=t.shift(),i=e[n];t.forEach(function(t){e[t]=i})}},{}],3:[function(t,e){e.exports=function(t){return t.replace(/(?:^|[-_])(\w)/g,function(t,e){return e?e.toUpperCase():""})}},{}],4:[function(t,e){function n(){"use strict";this.$Dispatcher_handlers={},this.$Dispatcher_processed={},this.$Dispatcher_tokenList=[],this.$Dispatcher_queue=[],this.active=!1}var i=t("./uid"),r=t("./now"),s=10;n.prototype.$Dispatcher_destructor=function(){"use strict";this.$Dispatcher_handlers=null,this.$Dispatcher_processed=null,this.$Dispatcher_tokenList=null,this.$Dispatcher_queue=null,this.active=!1},n.prototype.dispose=function(){"use strict";this.$Dispatcher_destructor()},n.prototype.register=function(t,e){"use strict";e&&this.$Dispatcher_handlers.hasOwnProperty(e)&&(e=i());var n=e||i();return this.$Dispatcher_handlers[n]=t,this.$Dispatcher_tokenList=Object.keys(this.$Dispatcher_handlers),n},n.prototype.deregister=function(t){"use strict";var e;return(e=this.$Dispatcher_handlers[t])&&delete this.$Dispatcher_handlers[t],e},n.prototype.waitFor=function(t){"use strict";if(!this.active)return this;for(var e=0,n=t.length;n>e;e++){var i=t[e].token||t[e];this.$Dispatcher_callHandler(i)}return this},n.prototype.dispatch=function(t,e){"use strict";if(this.active)return this.$Dispatcher_queue.push([t,e]),this;var n,i,o=this.$Dispatcher_tokenList.length,a=0;if(o){for(n=r(),this.active=!0,this.$Dispatcher_currentAction=t,this.$Dispatcher_processed={};o>a;)this.$Dispatcher_callHandler(this.$Dispatcher_tokenList[a]),a+=1;this.$Dispatcher_currentAction=null,this.active=!1,i=r()-n,i>s&&window.console.info("Dispatch of",t.type,"took >",s,"ms")}if(e&&e(),this.$Dispatcher_queue.length){var c=this.$Dispatcher_queue.shift();this.dispatch(c[0],c[1])}return this},n.prototype.$Dispatcher_callHandler=function(t){"use strict";if(this.$Dispatcher_processed[t]!==!0&&this.active){var e=this.$Dispatcher_handlers[t];e.call(this,this.$Dispatcher_currentAction,this,t),this.$Dispatcher_processed[t]=!0}},n.getInstance=function(){"use strict";return null===o&&(o=new n),o};var o=null;e.exports=n},{"./now":9,"./uid":11}],5:[function(t,e){var n=t("./camelize");e.exports=function(t){return{onStoreEvent:function(e,i,r){e=e.name||e;var s,o=t.getInstance(e);o&&(i=n(i),(s=o["on"+i])?(s(r),this._storeListeners||(this._storeListeners=[]),this._storeListeners.push({storeName:e,eventName:i,callback:r})):t.settings.verbose&&console.warn("Storefront: Event",i,"isn't supported by store:",e))},componentWillUnmount:function(){this._storeListeners&&(this._storeListeners.forEach(function(e){var n=e,i=n.storeName,r=n.eventName,s=n.callback,o=t.getInstance(i);o["off"+r](s)}),this._storeListeners.length=0,this._storeListeners=null)}}}},{"./camelize":3}],6:[function(t,e){e.exports=function(t){var e=[];return e.concat.apply(e,t)}},{}],7:[function(t,e){(function(n){var i=(t("./merge"),t("./alias")),r=t("./camelize"),s=t("elucidata-type");e.exports=function(){function t(t,e,n){"use strict";this.runtime=t,this.name=e,this.$Manager_instance=n,this.$Manager_handlers={},this.$Manager_notifyEvent=t.createEvent(e,"notify"),this.$Manager_changeEvent=t.createEvent(e,"change"),this.expose(this.$Manager_notifyEvent.public),this.expose(this.$Manager_changeEvent.public),i(this,"action","actions"),i(this,"handle","handles","observe","observes"),i(this,"expose","exposes","provide","provides"),i(this,"createEvent","defineEvent"),i(this,"hasChanged","dataDidChange","dataHasChanged"),null==n.token&&(n.token=t.dispatcher.register(function(t){var e;(e=this.$Manager_handlers[t.type])&&e(t)}.bind(this)))}return t.prototype.dispatch=function(t,e,i){"use strict";this.runtime.settings.aysncDispatch?n.nextTick(function(){this.runtime.dispatcher.dispatch({origin:this.name,type:t,payload:e},i)}.bind(this)):this.runtime.dispatcher.dispatch({origin:this.name,type:t,payload:e},i)},t.prototype.notify=function(t){"use strict";this.$Manager_notifyEvent.emit(t)},t.prototype.action=function(t){"use strict";Object.keys(t).forEach(function(e){var n=this.name+"_"+e,i=t[e],r=this.dispatch.bind(this,n);i.displayName=n,this.$Manager_instance[e]=i.bind(this.$Manager_instance,r)}.bind(this))},t.prototype.handle=function(t,e){"use strict";1===arguments.length?(e=t,t=this.name):s.isObject(t)&&(t=t.name),Object.keys(e).forEach(function(n){var i=t+"_"+n,r=e[n];this.$Manager_handlers[i]=r}.bind(this))},t.prototype.waitFor=function(){"use strict";for(var t=[],e=0,n=arguments.length;n>e;e++)t.push(arguments[e]);t=t.map(function(t){return s.isString(t)?this.runtime.getInstance(t):t}.bind(this)),this.runtime.dispatcher.waitFor(t)},t.prototype.hasChanged=function(){"use strict";this.$Manager_changeEvent.emitFlat(arguments)},t.prototype.expose=function(t){"use strict";Object.keys(t).forEach(function(e){if(this.$Manager_instance.hasOwnProperty(e)){var n=new Error("Redefining property "+e+" on store "+this.name);throw n.framesToPop=3,n}this.$Manager_instance[e]=t[e]}.bind(this))},t.prototype.getClerk=function(){"use strict";return this.$Manager_instance},t.prototype.getStore=function(t){"use strict";return t?this.runtime.getInstance(t,!0):this.$Manager_instance},t.prototype.createEvent=function(t){"use strict";var e=this.runtime.createEvent(name,t),n=e.emit.bind(e);return this.expose(e.public),this.$Manager_instance["emit"+r(t)]=n,n},t.prototype.resetInternals=function(){"use strict";this.$Manager_handlers={},this.$Manager_instance.token&&this.runtime.dispatcher.deregister(this.$Manager_instance.token),Object.keys(this.$Manager_instance).forEach(function(t){"name"!==t&&delete this.$Manager_instance[t]}.bind(this))},t}()}).call(this,t("_process"))},{"./alias":2,"./camelize":3,"./merge":8,_process:13,"elucidata-type":14}],8:[function(t,e){e.exports=function(){var t=Array.prototype.slice.call(arguments),e=t.shift();return t.forEach(function(t){Object.keys(t).forEach(function(n){e[n]=t[n]})}),e}},{}],9:[function(t,e){var n=function(){return"object"==typeof performance&&performance.now?performance.now.bind(performance):Date.now?Date.now.bind(Date):function(){return(new Date).getTime()}}();e.exports=n},{}],10:[function(t,e){(function(n){function i(){"use strict";s.call(this),this.dispatcher=r.getInstance(),this.registry={},this.managers={},this.builders=[],this.events={},this.$Runtime_anyChangeEvent=this.createEvent("*","any-change"),this.$Runtime_dataChanges=[],this.$Runtime_timer=!1,this.configure()}var r=t("./dispatcher"),s=t("events").EventEmitter,o=t("./manager"),a=t("elucidata-type"),c=t("./camelize"),h=t("./merge"),u=t("./flatten"),p=t("./uid"),f=t("./alias");for(var l in s)s.hasOwnProperty(l)&&(i[l]=s[l]);var d=null===s?null:s.prototype;i.prototype=Object.create(d),i.prototype.constructor=i,i.__superConstructor__=s,i.prototype.configure=function(t){"use strict";this.settings=h({asyncDispatch:!0,freezeInstance:!1,useRAF:!1,verbose:!0},t||{})},i.prototype.createEvent=function(t,e){"use strict";var i=t+":"+e,r=null;return(r=this.events[i])?r:(r={"public":{},emit:function(){var t=Array.prototype.slice.call(arguments);t.unshift(i),n.nextTick(function(){this.emit.apply(this,t)}.bind(this))}.bind(this),emitNow:function(){var t=Array.prototype.slice.call(arguments);t.unshift(i),this.emit.apply(this,t)}.bind(this),emitFlat:function(){var t=u([i].concat(Array.prototype.slice.call(arguments)));n.nextTick(function(){this.emit.apply(this,t)}.bind(this))}.bind(this)},r.public["on"+c(e)]=function(t){this.on(i,t)}.bind(this),r.public["off"+c(e)]=function(t){this.removeListener(i,t)}.bind(this),this.events[i]=r,r)},i.prototype.knownEvents=function(){"use strict";return Object.keys(this.events)},i.prototype.defineStore=function(t,e){"use strict";return a.isUndefined(e)&&(e=t,t=p()),this.$Runtime_buildFactory(t,e)},i.prototype.getInstance=function(t,e){"use strict";var n=this.registry[t];return n||(this.settings.verbose&&console.warn("Storefront: Store",t,"is not defined."),e===!0&&(this.settings.verbose&&console.info("Building stub for ",t),n={name:t},this.registry[t]=n)),n},i.prototype.getManager=function(t){"use strict";return this.managers[t]},i.prototype.hasStore=function(t){"use strict";return this.registry.hasOwnProperty(t)},i.prototype.onAnyChange=function(t){"use strict";this.$Runtime_anyChangeEvent.public.onAnyChange(t)},i.prototype.offAnyChange=function(t){"use strict";this.$Runtime_anyChangeEvent.public.offAnyChange(t)},i.prototype.recreateStore=function(t){"use strict";var e=this.getManager(t);return e&&e.resetInternals(),this.builders.filter(function(e){return e.name===t}).forEach(function(t){this.$Runtime_buildFactory(t.name,t.builder,!1)}.bind(this)),this.getInstance(t)},i.prototype.$Runtime_buildFactory=function(t,e,n){"use strict";var i,r=this.registry[t],s=this.managers[t];if(r&&this.settings.verbose&&console.warn(t,"already defined: Merging definitions."),r||(r={name:t},this.registry[t]=r),s||(s=new o(this,t,r),this.managers[t]=s,this.$Runtime_trackChangeFor(t)),a.isFunction(e))i=e(s);else{if(!a.isObject(e))throw new Error("Wrong builder type: Must provide a builder function or object.");i=e}return a.isObject(i)&&s.expose(i),this.settings.freezeInstance===!0&&Object.freeze(r),n!==!1&&this.builders.push({name:t,builder:e,manager:s}),this.getInstance(t)},i.prototype.$Runtime_trackChangeFor=function(t){"use strict";var e=t+":change";this.on(e,function(){this.$Runtime_dataChanges.push({type:e,params:Array.prototype.slice.call(arguments)}),this.$Runtime_timer||(n.nextTick(this.$Runtime_relayDataChanges.bind(this)),this.$Runtime_timer=!0)}.bind(this))},i.prototype.$Runtime_relayDataChanges=function(){"use strict";this.$Runtime_dataChanges.length&&(this.$Runtime_anyChangeEvent.emitNow(this.$Runtime_dataChanges),this.$Runtime_dataChanges=[]),this.$Runtime_timer=!1},i.newInstance=function(){"use strict";var e=new i,n={define:e.defineStore.bind(e),get:e.getInstance.bind(e),configure:e.configure.bind(e),onChange:e.onAnyChange.bind(e),offChange:e.offAnyChange.bind(e),mixins:{eventHelper:t("./event-helper-mixin")(e)},newInstance:i.newInstance,_internals:e};return f(n,"define","defineStore","Store","defineClerk","Clerk"),n},e.exports=i}).call(this,t("_process"))},{"./alias":2,"./camelize":3,"./dispatcher":4,"./event-helper-mixin":5,"./flatten":6,"./manager":7,"./merge":8,"./uid":11,_process:13,"elucidata-type":14,events:12}],11:[function(t,e){function n(t){var e=Math.floor((new Date).getTime()/1e3);for(t=t||36;i>=e;)e+=1;return i=e,e.toString(t)}var i=0;e.exports=n},{}],12:[function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function r(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!r(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,r,a,c,h;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[t],o(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,a=new Array(r-1),c=1;r>c;c++)a[c-1]=arguments[c];n.apply(this,a)}else if(s(n)){for(r=arguments.length,a=new Array(r-1),c=1;r>c;c++)a[c-1]=arguments[c];for(h=n.slice(),r=h.length,c=0;r>c;c++)h[c].apply(this,a)}return!0},n.prototype.addListener=function(t,e){var r;if(!i(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned){var r;r=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,r,o,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],o=n.length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(a=o;a-->0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?i(t._events[e])?1:t._events[e].length:0}},{}],13:[function(t,e){function n(){}var i=e.exports={};i.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};var i=[];if(e){var r=document.createElement("div"),s=new MutationObserver(function(){var t=i.slice();i.length=0,t.forEach(function(t){t()})});return s.observe(r,{attributes:!0}),function(t){i.length||r.setAttribute("yes","no"),i.push(t)}}return n?(window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),i.length>0)){var n=i.shift();n()}},!0),function(t){i.push(t),window.postMessage("process-tick","*")}):function(t){setTimeout(t,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=n,i.addListener=n,i.once=n,i.off=n,i.removeListener=n,i.removeAllListeners=n,i.emit=n,i.binding=function(){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(){throw new Error("process.chdir is not supported")}},{}],14:[function(t,e){(function(){var t,n,i,r,s,o,a,c,h;for(h="Boolean Number String Function Array Date RegExp Undefined Null NodeList".split(" "),i=/element$/,o=Object.keys||function(t){var e,n,i;i=[];for(e in t)n=t[e],i.push(e);return i},n=function(){var t,e,n,i,r,s;for(i=Object.prototype.toString,e=/\[object HTML(.*)\]/,t={},r=0,s=h.length;s>r;r++)n=h[r],t["[object "+n+"]"]=n.toLowerCase();return function(n){var r,s;return s=i.call(n),(r=t[s])?r:(r=s.match(e))?r[1].toLowerCase():"object"}}(),c=h.concat(["Object"]),r=function(t){var e;return e=t.toLowerCase(),n["is"+t]=function(t){return n(t)===e},n["isNot"+t]=function(t){return n(t)!==e}},s=0,a=c.length;a>s;s++)t=c[s],r(t);n.isEmpty=function(t){switch(n(t)){case"null":return!0;case"undefined":return!0;case"string":return""===t;case"object":return 0===o(t).length;case"array":return 0===t.length;case"number":return isNaN(t);case"nodelist":return 0===t.length;default:return!1}},n.isNotEmpty=function(t){return!n.isEmpty(t)},n.isElement=function(t){return i.test(n(t))},n.isNotElement=function(t){return!n.isElement(t)},"undefined"!=typeof e&&null!==e?e.exports=n:this.type=n}).call(this)},{}]},{},[1])(1)});