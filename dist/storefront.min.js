!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Storefront=e()}}(function(){return function e(t,n,r){function i(o,a){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[o]={exports:{}};t[o][0].call(h.exports,function(e){var n=t[o][1][e];return i(n?n:e)},h,h.exports,e,t,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t){t.exports=e("./lib/core")},{"./lib/core":4}],2:[function(e,t){t.exports=function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),n=e.shift(),r=t[n];e.forEach(function(e){t[e]=r})}},{}],3:[function(e,t){(function(n){function r(e,t,r){var o,a={},c=function(r,i,s){n.nextTick(function(){e.dispatcher.dispatch({origin:t,type:r,payload:i},s)})};c.send=c;var u={actions:function(e){return Object.keys(e).forEach(function(n){var r=t+"_"+n,i=e[n],s=c.bind(null,r);i.displayName=r,a[n]=i.bind(a,s)}),this},getStore:function(){return e.getInstance("store",t)}};return i(u,"actions","action","public"),o=s.isFunction(r)?r(u,u.actions):r,s.isObject(o)&&u.actions(o),a}var i=e("./alias"),s=e("elucidata-type");t.exports=r}).call(this,e("_process"))},{"./alias":2,_process:13,"elucidata-type":14}],4:[function(e,t){var n=e("./runtime"),r=new n;t.exports={Store:function(e,t){return r.defineStore(e,t)},Clerk:function(e,t){return r.defineClerk(e,t)},Facade:function(e,t){return r.defineFacade(e,t)},onChange:function(e){r.onAnyChange(e)},offChange:function(e){r.offAnyChange(e)},_internals:r}},{"./runtime":9}],5:[function(e,t){function n(){"use strict";this.$Dispatcher_handlers={},this.$Dispatcher_processed={},this.$Dispatcher_tokenList=[],this.$Dispatcher_queue=[],this.active=!1}var r=e("./uid"),i=e("./now"),s=10;n.prototype.$Dispatcher_destructor=function(){"use strict";this.$Dispatcher_handlers=null,this.$Dispatcher_processed=null,this.$Dispatcher_tokenList=null,this.$Dispatcher_queue=null,this.active=!1},n.prototype.dispose=function(){"use strict";this.$Dispatcher_destructor()},n.prototype.register=function(e,t){"use strict";t&&this.$Dispatcher_handlers.hasOwnProperty(t)&&(t=r());var n=t||r();return this.$Dispatcher_handlers[n]=e,this.$Dispatcher_tokenList=Object.keys(this.$Dispatcher_handlers),n},n.prototype.deregister=function(e){"use strict";var t;return(t=this.$Dispatcher_handlers[e])&&delete this.$Dispatcher_handlers[e],t},n.prototype.waitFor=function(e){"use strict";if(!this.active)return this;for(var t=0,n=e.length;n>t;t++){var r=e[t].token||e[t];this.$Dispatcher_callHandler(r)}return this},n.prototype.dispatch=function(e,t){"use strict";if(this.active)return this.$Dispatcher_queue.push([e,t]),this;DEBUG&&(console.time(e.type),console.group(e.type));var n,r,o=this.$Dispatcher_tokenList.length,a=0;if(o){for(n=i(),this.active=!0,this.$Dispatcher_currentAction=e,this.$Dispatcher_processed={};o>a;)this.$Dispatcher_callHandler(this.$Dispatcher_tokenList[a]),a+=1;this.$Dispatcher_currentAction=null,this.active=!1,r=i()-n,r>s&&window.console.info("Dispatch took >",s,"ms")}if(DEBUG&&(console.debug((r||0)+"ms"),console.timeEnd(e.type),console.groupEnd(e.type)),t&&t(),this.$Dispatcher_queue.length){var c=this.$Dispatcher_queue.shift();this.dispatch(c[0],c[1])}return this},n.prototype.$Dispatcher_callHandler=function(e){"use strict";if(this.$Dispatcher_processed[e]!==!0&&this.active){var t=this.$Dispatcher_handlers[e];t.call(this,this.$Dispatcher_currentAction,this,e),this.$Dispatcher_processed[e]=!0}},n.getInstance=function(){"use strict";return null===o&&(o=new n),o};var o=null;t.exports=n},{"./now":8,"./uid":11}],6:[function(e,t){function n(e,t,n,r,i,s,o,a){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,r,i,s,o,a],h=0;c=new Error("Violation: "+t.replace(/%s/g,function(){return u[h++]}))}throw c.framesToPop=1,c}}t.exports=n},{}],7:[function(e,t){function n(e){"use strict";this.name=e}function r(e,t,r){var a,c=e.getInstance("clerk",t),u=e.getInstance("store",t),h=new n(t),f={exposes:function(e){Object.keys(e).forEach(function(t){h[t]=e[t]})}};return o(c&&u,"A Store and Clerk are required to create a facade for: "+t),s(f,"exposes","expose","public"),a=i.isFunction(r)?r(f):r,i.isObject(a)&&f.exposes(a),h=Object.merge(h,c),h=Object.merge(h,u),Object.freeze(h)}var i=e("elucidata-type"),s=e("./alias"),o=e("./ensure");t.exports=r},{"./alias":2,"./ensure":6,"elucidata-type":14}],8:[function(e,t){var n=function(){return"object"==typeof performance&&performance.now?performance.now.bind(performance):Date.now?Date.now.bind(Date):function(){return(new Date).getTime()}}();t.exports=n},{}],9:[function(e,t){(function(n){function r(){"use strict";c.call(this),this.dispatcher=o.getInstance(),this.registry={store:{},clerk:{},facade:{}},this.factories={store:{},clerk:{},facade:{}},this.events={},this.$Runtime_anyChangeEvent=this.createEvent("*","any-change"),this.$Runtime_dataChanges=[],this.$Runtime_timer=!1}var i=e("./store-factory"),s=e("./clerk-factory"),o=e("./dispatcher"),a=e("./facade"),c=e("events").EventEmitter;for(var u in c)c.hasOwnProperty(u)&&(r[u]=c[u]);var h=null===c?null:c.prototype;r.prototype=Object.create(h),r.prototype.constructor=r,r.__superConstructor__=c,r.prototype.createEvent=function(e,t){"use strict";var r=e+":"+t,i=null;return(i=this.events[r])?i:(i={"public":{},emit:function(){var e=Array.prototype.slice.call(arguments);e.unshift(r),n.nextTick(function(){this.emit.apply(this,e)}.bind(this))}.bind(this),emitNow:function(){var e=Array.prototype.slice.call(arguments);e.unshift(r),this.emit.apply(this,e)}.bind(this),emitFlat:function(){var e=[r].concat(Array.prototype.slice.call(arguments)).flatten();n.nextTick(function(){this.emit.apply(this,e)}.bind(this))}.bind(this)},i.public["on"+t.camelize(!0)]=function(e){this.on(r,e)}.bind(this),i.public["off"+t.camelize(!0)]=function(e){this.removeListener(r,e)}.bind(this),this.events[r]=i,i)},r.prototype.knownEvents=function(){"use strict";return Object.keys(this.events)},r.prototype.defineStore=function(e,t){"use strict";if(this.hasStore(e))throw new Error("Store "+e+" already defined!");this.factories.store[e]=t;var n=this.registry.store[e]=i(this,e,t);return this.$Runtime_trackChangeFor(e),n},r.prototype.defineClerk=function(e,t){"use strict";if(this.hasClerk(e))throw new Error("Clerk "+e+" already defined!");this.factories.clerk[e]=t;var n=this.registry.clerk[e]=s(this,e,t);return n},r.prototype.defineFacade=function(e,t){"use strict";if(this.hasFacade(e))throw new Error("Facade "+e+" already defined!");this.factories.facade[e]=t;var n=this.registry.facade[e]=a(this,e,t);return n},r.prototype.getInstance=function(e,t){"use strict";return this.registry[e][t]},r.prototype.getFactory=function(e,t){"use strict";return this.factories[e][t]},r.prototype.hasStore=function(e){"use strict";return this.registry.store.hasOwnProperty(e)},r.prototype.hasClerk=function(e){"use strict";return this.registry.clerk.hasOwnProperty(e)},r.prototype.hasFacade=function(e){"use strict";return this.registry.facade.hasOwnProperty(e)},r.prototype.onAnyChange=function(e){"use strict";this.$Runtime_anyChangeEvent.public.onAnyChange(e)},r.prototype.offAnyChange=function(e){"use strict";this.$Runtime_anyChangeEvent.public.offAnyChange(e)},r.prototype.$Runtime_trackChangeFor=function(e){"use strict";var t=e+":change";this.on(t,function(){this.$Runtime_dataChanges.push({type:t,params:Array.prototype.slice.call(arguments)}),this.$Runtime_timer||(n.nextTick(this.$Runtime_relayDataChanges.bind(this)),this.$Runtime_timer=!0)}.bind(this))},r.prototype.$Runtime_relayDataChanges=function(){"use strict";this.$Runtime_dataChanges.length&&(this.$Runtime_anyChangeEvent.emitNow(this.$Runtime_dataChanges),this.$Runtime_dataChanges=[]),this.$Runtime_timer=!1},t.exports=r}).call(this,e("_process"))},{"./clerk-factory":3,"./dispatcher":5,"./facade":7,"./store-factory":10,_process:13,events:12}],10:[function(e,t){function n(e,t,n){var s,o={},a={},c=e.createEvent(t,"notify"),u=e.createEvent(t,"change"),h={waitFor:function(){for(var t=[],n=0,r=arguments.length;r>n;n++)t.push(arguments[n]);return e.dispatcher.waitFor(t)},hasChanged:function(){u.emitFlat(arguments)},notify:function(e){c.emit(e)},deliver:function(e){Object.keys(e).forEach(function(t){a[t]=e[t]})},handle:function(n,r){1===arguments.length&&(r=n,n=e.getInstance("facade",t));var i=function(e){return t+"_"+e};Object.keys(r).forEach(function(e){var t=i(e),n=r[e];o[t]=n})},createEvent:function(n){var r=e.createEvent(t,n),i=r.emit.bind(r);return this.deliver(r.public),this["emit"+n.camelize(!0)]=i,i},getClerk:function(){return e.getInstance("clerk",t)}};return r(h,"handle","handles"),r(h,"hasChanged","dataDidChange","dataHasChanged"),r(h,"deliver","delivers","provide","provides","public"),h.deliver(u.public),h.deliver(c.public),s=i.isFunction(n)?n(h,h.hasChanged,h.waitFor,h.notify):n,i.isObject(s)&&h.deliver(s),r(a,"onChange","onDataChange"),r(a,"offChange","offDataChange"),a.id=e.dispatcher.register(function(e){var t;(t=o[e.type])&&t(e)}),a}var r=e("./alias"),i=e("elucidata-type");t.exports=n},{"./alias":2,"elucidata-type":14}],11:[function(e,t){function n(e){var t=Math.floor((new Date).getTime()/1e3);for(e=e||36;r>=t;)t+=1;return r=t,t.toString(e)}var r=0;t.exports=n},{}],12:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,a,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],o(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),c=1;i>c;c++)a[c-1]=arguments[c];n.apply(this,a)}else if(s(n)){for(i=arguments.length,a=new Array(i-1),c=1;i>c;c++)a[c-1]=arguments[c];for(u=n.slice(),i=u.length,c=0;i>c;c++)u[c].apply(this,a)}return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned){var i;i=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,o,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(a=o;a-->0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],13:[function(e,t){function n(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};var r=[];if(t){var i=document.createElement("div"),s=new MutationObserver(function(){var e=r.slice();r.length=0,e.forEach(function(e){e()})});return s.observe(i,{attributes:!0}),function(e){r.length||i.setAttribute("yes","no"),r.push(e)}}return n?(window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(e){r.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},{}],14:[function(e,t){(function(){var e,n,r,i,s,o,a,c,u;for(u="Boolean Number String Function Array Date RegExp Undefined Null NodeList".split(" "),r=/element$/,o=Object.keys||function(e){var t,n,r;r=[];for(t in e)n=e[t],r.push(t);return r},n=function(){var e,t,n,r,i,s;for(r=Object.prototype.toString,t=/\[object HTML(.*)\]/,e={},i=0,s=u.length;s>i;i++)n=u[i],e["[object "+n+"]"]=n.toLowerCase();return function(n){var i,s;return s=r.call(n),(i=e[s])?i:(i=s.match(t))?i[1].toLowerCase():"object"}}(),c=u.concat(["Object"]),i=function(e){var t;return t=e.toLowerCase(),n["is"+e]=function(e){return n(e)===t},n["isNot"+e]=function(e){return n(e)!==t}},s=0,a=c.length;a>s;s++)e=c[s],i(e);n.isEmpty=function(e){switch(n(e)){case"null":return!0;case"undefined":return!0;case"string":return""===e;case"object":return 0===o(e).length;case"array":return 0===e.length;case"number":return isNaN(e);case"nodelist":return 0===e.length;default:return!1}},n.isNotEmpty=function(e){return!n.isEmpty(e)},n.isElement=function(e){return r.test(n(e))},n.isNotElement=function(e){return!n.isElement(e)},"undefined"!=typeof t&&null!==t?t.exports=n:this.type=n}).call(this)},{}]},{},[1])(1)});